<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Training Program</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Thai:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#fff7ed;
      --card:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --line:#e5e7eb;
      --accent:#f97316;

      /* Header row (สวย-มืออาชีพขึ้น + อ่านง่าย) */
--thBg:#fb923c;        /* ส้มเข้ม */
--thBg2:#f97316;       /* ไล่เฉดด้านล่าง */
--thText:#ffffff;      /* ตัวอักษรขาว */
--thBorder:rgba(255,255,255,0.35);    /* เส้นคั่น */

/* Accent for key columns (ใช้เส้น/ไฮไลต์แบบสุภาพ) */
--dateAccent:#fb923c;
--statusAccent:#f472b6;

/* Status badges */
      --wait:#fde68a;  --waitText:#92400e;
      --done:#bbf7d0;  --doneText:#166534;
      --hold:#dbeafe;  --holdText:#1e40af;
      --cancel:#fee2e2;--cancelText:#991b1b;
      --other:#e5e7eb; --otherText:#374151;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:"Inter","IBM Plex Sans Thai",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
      background:var(--bg);
      color:var(--text);
      letter-spacing:.2px;
    }

    /* Header */
    .topbar{background:#fff;border-bottom:1px solid var(--line);}
    .topbar-inner{
      max-width:1200px;margin:0 auto;padding:18px 16px;
      display:flex;align-items:center;gap:18px;
    }
    .brand-logo{height:84px;width:auto;display:block;}
    .title{margin:0;font-size:32px;font-weight:700;line-height:1.1;}
    .title small{font-size:18px;font-weight:600;color:var(--muted);margin-left:10px;}

    .wrap{max-width:1200px;margin:0 auto;padding:18px 16px 28px;}
    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;overflow:hidden;}

    /* Filters */
    .filters{
      padding:14px;display:flex;gap:12px;flex-wrap:wrap;align-items:center;
      border-bottom:1px solid var(--line);background:#fff;
    }
    select,input{
      font-family:inherit;
      padding:11px 14px;border-radius:14px;border:1px solid #e5e7eb;
      background:#fff;font-size:15px;outline:none;
    }
    .btn{
      cursor:pointer;border:0;
      padding:11px 16px;border-radius:14px;background:var(--accent);
      color:#fff;font-weight:700;font-size:15px;
      font-family:inherit;line-height:1;
    }

    .notice{padding:10px 14px 0;font-size:14px;color:#9a3412;}
    .error{
      margin:10px 14px 12px;padding:10px 12px;border-radius:12px;
      background:#fff1f2;border:1px solid #fecdd3;color:#9f1239;font-size:13px;display:none;
    }
    .error a{color:#9f1239;font-weight:600;text-decoration:underline;}

    /* Table (พอดีหน้าจอเดียว) */
    .tablewrap{width:100%;overflow:auto;max-height:70vh;border-top:1px solid rgba(0,0,0,0.03);-webkit-overflow-scrolling:touch;}
    table{width:100%;min-width:980px;border-collapse:separate;border-spacing:0;}

    thead th{
  position:sticky; top:0; z-index:3;
  background: linear-gradient(180deg, var(--thBg), var(--thBg2));
  color: var(--thText);
  border-bottom: 1px solid var(--thBorder);
  border-right: 1px solid rgba(0,0,0,0.04);
  font-size: 14.5px;
  font-weight: 800;
  padding: 12px 10px;
  text-align: center;
  white-space:nowrap; /* ไม่ให้หัวข้อซ้อน/ตัดเป็นแนวตั้ง */
  line-height: 1.2;
  box-shadow: 0 1px 0 rgba(0,0,0,0.02);
}
thead th:last-child{ border-right: 0; }
    thead th:first-child{border-top-left-radius:14px;}
    thead th:last-child{border-top-right-radius:14px;}

    thead th.th-date{
  background: linear-gradient(180deg, var(--thBg), var(--thBg2));
  box-shadow: none;
}
thead th.th-status{
  background: linear-gradient(180deg, var(--thBg), var(--thBg2));
  box-shadow: none;
}
tbody td{
      border-bottom:1px solid var(--line);
      padding:10px;
      font-size:14px;
      vertical-align:middle;
      background:#fff;
      text-align:center;
    }
    

/* Prevent text stacking in cells; allow horizontal scroll instead */
thead th, tbody td{
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

tbody tr:nth-child(even) td{background:#fffdfa;}
    tbody tr:hover td{background:#fff2e5;}

    /* Column widths (รวม ~100%) */
    .col-group{width:12%}
    .col-course{width:25%}
    .col-batch{width:6%}
    .col-trainer{width:23%}
    .col-date{width:14%;white-space:nowrap}
    .col-status{width:10%}   /* ✅ เพิ่มให้สถานะขึ้นครบ */
    .col-link{width:10%}

    .clamp2{
      display:-webkit-box;
      -webkit-box-orient:vertical;
      -webkit-line-clamp:2;
      overflow:hidden;
      line-height:1.25;
      word-break:break-word;
    }
    .mono{font-variant-numeric:tabular-nums;}

    /* Status badge: ไม่ตัดคำ + แสดงครบ */
    .badge{
      display:inline-block;
      max-width: 100%;
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:800;
      line-height:1.15;
      white-space:nowrap;      /* กันข้อความซ้อนแนวตั้ง */
      overflow:hidden;
      text-overflow:ellipsis;
      vertical-align:middle;
    }
    .b-wait{background:var(--wait);color:var(--waitText);}
    .b-done{background:var(--done);color:var(--doneText);}
    .b-hold{background:var(--hold);color:var(--holdText);}
    .b-cancel{background:var(--cancel);color:var(--cancelText);}
    .b-other{background:var(--other);color:var(--otherText);}

    a.dl{
      display:inline-flex;align-items:center;justify-content:center;
      padding:8px 10px;border-radius:12px;background:var(--accent);color:#fff;
      text-decoration:none;font-weight:800;font-size:13px;white-space:nowrap;
      font-family:inherit;
    }

    .foot{padding:12px 14px 14px;font-size:12.5px;color:#9a3412;background:#fff;border-top:1px solid var(--line);letter-spacing:.2px;}

    @media (max-width: 560px){
      .brand-logo{height:72px;}
      .title{font-size:24px;}
      .title small{font-size:16px;}
      select,input,.btn{font-size:14px;}
      thead th{font-size:14px;}
      tbody td{font-size:13px;}
    }
  

/* v14.4: Expand white container further */
.container-card{
  max-width: 1700px;
  margin: 40px auto;
  padding: 36px 44px;
  background: #ffffff;
  border-radius: 18px;
  box-shadow: 0 10px 28px rgba(0,0,0,0.10);
}
@media (max-width: 640px){
  .container-card{
    padding: 20px 16px;
    margin: 20px 12px;
  }
}

@media (min-width: 1600px) {
  .container-card { max-width: 1600px; }
}


/* v14.3: Responsive padding (Desktop vs Mobile) */
thead th{ padding: 12px 10px; }
tbody td{ padding: 12px 10px; }

@media (max-width: 640px){
  .container-card{ padding: 18px 16px; }
  thead th{ padding: 10px 8px; font-size: 13.5px; }
  tbody td{ padding: 10px 8px; font-size: 13.5px; }
}


/* v14.5: Force width 1400px on main container */
.container,
.container-lg,
.wrapper,
.main-container,
.page-container {
  max-width: 1400px !important;
  width: 100% !important;
  margin: 40px auto !important;
}

.container-card{
  padding: 36px 40px !important;
}


/* v14.6: Expand side white space + compact header */
body {
  padding-left: 8px !important;
  padding-right: 8px !important;
}

.page-container,
.main-wrapper,
.layout,
.app {
  padding-left: 0 !important;
  padding-right: 0 !important;
}

/* keep content width balanced */
.container,
.container-lg {
  max-width: 1400px;
  margin: 0 auto;
}

/* compact header */
.page-header {
  padding: 12px 0 !important;
}

.page-header h1 {
  font-size: 24px !important;
}

.page-header img,
.page-header .logo {
  height: 36px !important;
}


/* v14.7: Fix real containers (.wrap / .topbar-inner) to expand side white area */
.topbar-inner,
.wrap{
  max-width: 1400px !important;
  width: 100% !important;
  margin: 0 auto !important;
}

/* reduce side gutters a bit (still clean) */
.topbar-inner{ padding-left: 8px !important; padding-right: 8px !important; }
.wrap{ padding-left: 8px !important; padding-right: 8px !important; }


/* v14.8: Add inner gap so white frame doesn't stick to table header */
table{
  width: calc(100% - 24px) !important;
  margin: 12px !important;              /* gap around table */
  border-radius: 12px;
  overflow: hidden;                      /* keep header corners clean */
}

@media (max-width: 640px){
  table{
    width: calc(100% - 16px) !important;
    margin: 8px !important;
    border-radius: 10px;
  }
}


/* v14.9: Logo bigger, footer centered, register link fit */

/* Logo */
.page-header img,
.page-header .logo{
  height: 56px !important;   /* bigger logo */
}

/* Footer center */
.footer-note,
.footer,
.page-footer{
  text-align: center !important;
  margin-top: 12px;
}

/* Register link column fit */
th:last-child,
td:last-child{
  white-space: nowrap;
  width: 140px;
  text-align: center;
}


/* v14.9 (Download button): orange small button in last column */
td:last-child a{
  display:inline-block;
  padding:6px 14px;
  font-size:13px;
  font-weight:600;
  color:#fff !important;
  background:#ff7a00;
  border-radius:18px;
  text-decoration:none !important;
  white-space:nowrap;
}
td:last-child a:hover{ background:#e66f00; transform: translateY(-1px); }
.footer-note, footer{ text-align:center !important; }


    /* --- v1.0 UI tweaks (requested) --- */
    .topbar-inner{ position:relative; }
    .brand-logo{ height:96px; } /* bigger logo desktop */
    .title{ font-size:42px; font-weight:800; }
    .title small{ display:none; } /* hide old small subtitle if any */

    .version-badge{
      position:absolute;
      top:10px;
      right:8px;
      font-size:12.5px;
      font-weight:700;
      color:#374151;
      background:#ffffff;
      border:1px solid #e5e7eb;
      border-radius:999px;
      padding:6px 10px;
      line-height:1;
      box-shadow:0 4px 14px rgba(0,0,0,0.06);
      white-space:nowrap;
    }

    /* Filters: single row on desktop */
    .filters{
      flex-wrap:nowrap;
      gap:12px;
    }
    .filters select, .filters input{ min-width: 180px; }
    #search{ min-width: 220px; flex:1; }
    #reload{ white-space:nowrap; }

    /* Month/Year input look */
    #filterMonthYear{
      min-width: 180px;
    }

    /* Footer center */
    .foot{ text-align:center; }

    @media (max-width: 900px){
      .brand-logo{ height:82px; }
      .title{ font-size:32px; }
      .version-badge{ top:8px; right:8px; }
    }
    @media (max-width: 640px){
      .filters{ flex-wrap:wrap; }
      .filters select, .filters input{ min-width: 0; width: 100%; }
      #search{ width:100%; flex:unset; }
      #reload{ width:100%; }
      #filterMonthYear{ width:100%; }
    }


/* --- Fix dropdown arrow (v) padding & logo size --- */
select{
  padding-right: 42px !important; /* ดันลูกศร v เข้ามา ไม่ชิดกรอบ */
  background-position: right 14px center;
}

.brand-logo{
  height:110px !important; /* โลโก้ใหญ่ขึ้นอีก */
}

@media (max-width:900px){
  .brand-logo{
    height:92px !important;
  }
}


/* === FINAL micro-adjust (logo + dropdown arrow only) === */

/* Logo: enlarge to match reference */
.brand-logo{
  height:120px !important;
}

/* Dropdown arrow (v): pull inward safely */
select{
  padding-right:48px !important;
  background-position:right 18px center !important;
}

@media (max-width:900px){
  .brand-logo{
    height:100px !important;
  }
  select{
    padding-right:44px !important;
    background-position:right 16px center !important;
  }
}


/* === micro tweak only: +10px logo, +3px arrow === */
.brand-logo{
  height:130px !important; /* +10px */
}

select{
  padding-right:51px !important; /* +3px */
  background-position:right 21px center !important;
}

@media (max-width:900px){
  .brand-logo{
    height:110px !important;
  }
  select{
    padding-right:47px !important;
    background-position:right 19px center !important;
  }
}


/* === UI tweak only (no data logic touched) === */

/* 1) Dropdown arrow v: push inward +5px */
select{
  padding-right:56px !important;   /* +5px */
  background-position:right 26px center !important;
}

/* 2) Separate white card from light-orange background */
body{
  background:#fff4e8 !important; /* ส้มอ่อนตามตัวอย่าง */
}

.main-card{
  background:#ffffff !important;
  border-radius:18px;
  box-shadow:0 8px 28px rgba(0,0,0,0.06);
  padding:18px;
}

@media (max-width:900px){
  select{
    padding-right:52px !important;
    background-position:right 22px center !important;
  }
}


/* === Patch: background separation + dropdown arrow +5px (no data logic touched) === */

/* Background: light orange */
body{ background:#fff4e8 !important; }

/* White card container */
.card{
  background:#ffffff !important;
  border-radius:18px !important;
  box-shadow:0 8px 28px rgba(0,0,0,0.06) !important;
}

/* Dropdown arrow (v): push inward +5px from current */
select{
  padding-right:61px !important;
  background-position:right 31px center !important;
}

@media (max-width:900px){
  select{
    padding-right:57px !important;
    background-position:right 27px center !important;
  }
}


/* === FIX (only UI): make orange bg visible + custom dropdown arrow movable === */

/* show light-orange page background around the white card */
body{ background:#fff4e8 !important; }
.wrap{
  background:transparent !important;
  padding:28px 24px 40px !important;  /* create orange margins like reference */
}
@media (max-width:640px){
  .wrap{ padding:18px 14px 28px !important; }
}

/* white card stays as card */
.wrap .card{
  background:#fff !important;
  border:1px solid rgba(249,115,22,0.18) !important;
  border-radius:18px !important;
  box-shadow:0 10px 30px rgba(0,0,0,0.06) !important;
}

/* Custom dropdown arrow so we can shift it inward */
.filters select{
  -webkit-appearance:none !important;
  -moz-appearance:none !important;
  appearance:none !important;

  /* keep existing look */
  background-color:#fff !important;

  /* arrow icon */
  background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24'><path fill='%236b7280' d='M7 10l5 5 5-5z'/></svg>") !important;
  background-repeat:no-repeat !important;

  /* THIS is the inward shift (v) */
  background-position:right 21px center !important;

  /* make room for arrow */
  padding-right:58px !important;
}

@media (max-width:900px){
  .filters select{
    background-position:right 19px center !important;
    padding-right:54px !important;
  }
}


/* === Requested tweaks: bigger dropdown arrow + clear white header with orange gap === */

/* Bigger dropdown arrow */
.filters select{
  background-size:18px 18px !important; /* make v bigger */
  /* keep inward position */
}

/* Ensure header (logo/title) sits on white bar */
.topbar{
  background:#ffffff !important;
  border-bottom:1px solid rgba(17,24,39,0.08) !important;
}

/* Create orange gap between header and main white card */
.topbar{ margin-bottom:18px !important; } /* shows body bg (orange) as separator */
.wrap{ padding-top:10px !important; }      /* keep card spacing consistent */

@media (max-width:900px){
  .filters select{ background-size:17px 17px !important; }
  .topbar{ margin-bottom:14px !important; }
}


/* === Header / card separator EXACT like reference === */

/* White header bar */
.topbar{
  background:#ffffff !important;
  padding-bottom:18px !important;
  border-bottom:none !important;
}

/* Light-orange separator strip */
.header-gap{
  height:22px;
  background:#fff4e8;
}

/* Insert gap visually before main card */
.wrap{
  padding-top:0 !important;
}


/* === FORCE remove any outer white: make page bg orange everywhere === */
html, body{
  background:#fff4e8 !important;
  min-height:100%;
}
body{ margin:0 !important; }

/* ensure nothing creates a full-width white backdrop except topbar itself */
.wrap{ background:transparent !important; }

/* keep card as the only white block */
.wrap .card{ background:#fff !important; }

/* if any generic containers exist, make them transparent */
.container, .box, .outer, .page, .content{
  background:transparent !important;
}


/* === Background outside the card MUST be light orange (override all wrappers) === */
:root{ --bg:#fff4e8 !important; }

html, body{
  background:var(--bg) !important;
}

/* make header area not paint white over the orange */
.topbar, .topbar-inner{
  background:transparent !important;
  border:0 !important;
  box-shadow:none !important;
}

/* outer wrapper must be transparent */
.wrap{
  background:transparent !important;
}

/* only the main card stays white */
.card{
  background:#ffffff !important;
}


/* === FIX: Header background must be WHITE (only) === */
html, body{
  background:#fff4e8 !important;
}

.topbar{
  background:#ffffff !important;
}

.topbar-inner{
  background:#ffffff !important;
  border-radius:12px;
}

.wrap{
  background:transparent !important;
}


/* === FINAL FIX: White ONLY the header box (not full width) === */
html, body{
  background:#fff4e8 !important;
}

/* header strip stays transparent so outer area is orange */
.topbar{
  background:transparent !important;
}

/* white box only for header content */
.topbar-inner{
  background:#ffffff !important;
  border-radius:12px;
}

/* keep rest untouched */
.wrap{ background:transparent !important; }


/* === FINAL AGREED FIX === */
/* Outside background = light orange */
html, body{
  background:#fff4e8 !important;
}

/* Wrapper transparent so orange shows */
.wrap{
  background:transparent !important;
}

/* Card stays white */
.card{
  background:#ffffff !important;
}

/* Header content unchanged */
.topbar{
  background:transparent !important;
}
.topbar-inner{
  background:#ffffff !important;
}


/* === FINAL: Header white full width ONLY, nothing else touched === */

/* Header bar full-width white */
.topbar{
  background:#ffffff !important;
}

/* Header content stays same position/size */
.topbar-inner{
  background:transparent !important;
  max-width:1400px !important;
  margin:0 auto !important;
  padding:18px 16px !important;
}


/* === MATCH SAMPLE: full-width WHITE header bar + light-orange page bg (no other changes) === */

/* Page outside cards */
html, body{
  background:#fff4e8 !important;
}

/* Full-width white header bar (like sample) */
.topbar{
  background:#ffffff !important;
  border-bottom:1px solid rgba(17,24,39,0.10) !important; /* subtle divider like screenshot */
}

/* Keep logo/title/version positions unchanged */
.topbar-inner{
  background:transparent !important;
  max-width:1400px !important;
  margin:0 auto !important;
  padding:18px 16px !important;
}

/* Ensure main wrap doesn't paint white */
.wrap{ background:transparent !important; }


/* === FIX: Remove white band above lower card, show orange gap like reference === */

/* Ensure page background is light orange */
html, body{
  background:#fff4e8 !important;
}

/* Header stays white full width */
.topbar{
  background:#ffffff !important;
  border-bottom:0 !important;
}

/* Explicit orange gap between header and content */
.header-gap{
  display:block !important;
  height:20px !important;
  background:#fff4e8 !important;
}

/* Make sure wrap doesn't introduce white */
.wrap{
  background:transparent !important;
  padding-top:0 !important;
}


/* === PATCH: remove outer white, keep card white === */
html, body{
  background:#fff4e8 !important;
}
.wrap{
  background:transparent !important;
}
.card{
  background:#ffffff !important;
}
/* === END PATCH === */

/* === PATCH 2: ensure orange margin is visible around the card === */
.wrap{
  padding:24px 24px 40px !important;
}
@media (max-width:640px){
  .wrap{ padding:16px 14px 28px !important; }
}
/* === END PATCH 2 === */



/* === FINAL PATCH: requested tweaks only === */
/* Pull lower card up by 30px */
.wrap{
  margin-top:-30px !important;
}
/* === END FINAL PATCH === */


/* === FINAL PATCH: move white header box up 10px WITHOUT moving content === */
/* Move only the white background box */
.topbar{
  padding-top:0 !important;
}
.topbar-inner{
  margin-top:-10px !important;   /* move white box up */
}

/* Keep logo/title/version centered visually */
.topbar-inner{
  display:flex;
  align-items:center;
}
/* === END FINAL PATCH === */


/* === FINAL PATCH: header bg up +20px, content down === */
/* Move white header background further up */
.topbar-inner{
  margin-top:-30px !important; /* was -10, now total -30 */
}

/* Move logo/title/version down without affecting bg */
.topbar-inner > *{
  transform: translateY(20px);
}
/* === END FINAL PATCH === */


/* === FINAL PATCH: move header content down +10px more === */
/* Total content down = 30px */
.topbar-inner > *{
  transform: translateY(30px) !important;
}
/* === END FINAL PATCH === */


/* === PATCH (requested): filter controls behavior only === */

/* 1) Keep select widths stable so "หลักสูตร" button doesn't resize per selection */
.filters select{
  flex: 0 0 240px !important;
  width: 240px !important;
  max-width: 240px !important;
}
#filterCourse{
  flex: 0 0 360px !important;
  width: 360px !important;
  max-width: 360px !important;
}

/* 2) Use the month/year SELECT (works on iOS/Android reliably) */
#filterMonth{ display:block !important; }
#filterMonthYear{ display:none !important; }

/* === END PATCH === */


/* === PATCH: prevent Search/Refresh from disappearing when course name is long === */

/* Allow filter bar to wrap instead of pushing items off-screen */
.filters{
  flex-wrap:wrap !important;
  row-gap:12px !important;
}

/* Keep controls on the same visual size but responsive */
.filters select{
  width: 240px !important;
  max-width: 100% !important;
}
#filterCourse{
  width: 460px !important;      /* expand course box so long names fit better */
  max-width: 100% !important;
}

/* Search + Refresh should always stay visible */
#search{
  flex: 1 1 260px !important;
  min-width: 260px !important;
}
#reload{
  flex: 0 0 auto !important;
  min-width: 120px !important;
  white-space: nowrap !important;
}

/* Optional: expand overall content width a bit on large screens */
@media (min-width: 1200px){
  .topbar-inner, .wrap{ max-width: 1600px !important; }
}

/* === END PATCH === */

/* === MOBILE UI (match v7 reference) - CSS ONLY === */
@media (max-width: 640px){

  /* Header: logo centered, title below like sample */
  .topbar-inner{
    flex-direction:column !important;
    align-items:center !important;
    gap:10px !important;
    padding:16px 16px !important;
  }
  .brand-logo{
    height:90px !important;
    margin:0 auto !important;
  }
  .title{
    width:100% !important;
    font-size:30px !important;
    line-height:1.15 !important;
    text-align:left !important;
    margin:0 !important;
  }
  .version-badge{
    position:static !important;
    margin-top:6px !important;
    align-self:flex-end !important;
  }

  /* Card spacing */
  .wrap{ padding:16px 12px 28px !important; }
  .card{ border-radius:18px !important; }

  /* Filters block looks like an inner rounded frame */
  .filters{
    margin:14px 14px 8px !important;
    padding:16px !important;
    border:1px solid rgba(249,115,22,0.22) !important;
    border-radius:18px !important;
    background:#fff !important;
    box-shadow:0 6px 18px rgba(0,0,0,0.04) !important;
    border-bottom:1px solid rgba(249,115,22,0.22) !important; /* override original divider */
  }

  /* Inputs: pill, big, easy to tap */
  .filters select,
  .filters input{
    width:100% !important;
    min-width:0 !important;
    height:54px !important;
    padding:14px 18px !important;
    border-radius:999px !important;
    border:1px solid #e5e7eb !important;
    font-size:18px !important;
  }
  .filters select{
    font-weight:700 !important;
    color:#1e3a8a !important; /* blue like sample */
    background-size:20px 20px !important;
    background-position:right 20px center !important;
    padding-right:56px !important; /* room for arrow */
  }
  .filters input::placeholder{
    color:#9ca3af !important;
    font-weight:600 !important;
  }

  /* Search looks like other pills */
  #search{
    flex:unset !important;
  }

  /* Refresh: centered small pill button */
  #reload{
    width:auto !important;
    min-width:0 !important;
    padding:14px 26px !important;
    border-radius:999px !important;
    align-self:center !important;
    margin-top:2px !important;
  }

  /* Loading text spacing */
  .notice{
    padding:10px 18px 0 !important;
  }

  /* Table gap on mobile */
  table{
    margin:8px !important;
    width:calc(100% - 16px) !important;
  }
}
/* === END MOBILE UI PATCH === */



/* === MOBILE OVERRIDE (FINAL v4): logo 140px, title closer to logo === */
@media (max-width: 640px){

  .topbar-inner{
    position: relative !important;
    flex-direction: column !important;
    align-items: center !important;
    gap: 2px !important;              /* closer spacing */
    padding: 14px 16px !important;
  }

  /* LOGO: very big */
  .brand-logo{
    height: 140px !important;         /* REQUESTED */
    width: auto !important;
    margin: 0 auto !important;
    display: block !important;
  }

  /* TITLE: closer to logo */
  .title{
    margin-top: -6px !important;      /* pull title upward */
    margin-bottom: 0 !important;
    text-align: center !important;
    font-size: 20px !important;
    line-height: 1.1 !important;
    font-weight: 800 !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }

  /* VERSION: tiny top-right */
  .version-badge{
    position: absolute !important;
    top: 6px !important;
    right: 8px !important;
    font-size: 8px !important;
    padding: 2px 6px !important;
    line-height: 1 !important;
  }
}
/* === END MOBILE OVERRIDE (FINAL v4) === */



/* === MOBILE PATCH (v4 + title -14px ONLY) === */
@media (max-width: 640px){
  .title{
    margin-top: -14px !important; /* ONLY change requested */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: remove logo background ONLY === */
@media (max-width: 640px){
  .brand-logo{
    background: transparent !important;
    box-shadow: none !important;
    border-radius: 0 !important;
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: title closer to logo (-18px) ONLY === */
@media (max-width: 640px){
  .title{
    margin-top: -18px !important; /* closer to logo */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: FORCE title move closer to logo (translateY) ONLY === */
@media (max-width: 640px){
  .title{
    transform: translateY(-18px) !important;  /* force visible movement */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: title slightly below logo (translateY -8px) ONLY === */
@media (max-width: 640px){
  .title{
    transform: translateY(-8px) !important; /* closer but NOT under logo */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: title slightly lower (translateY -4px) ONLY === */
@media (max-width: 640px){
  .title{
    transform: translateY(-4px) !important; /* move DOWN a bit */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: title translateY -6px ONLY === */
@media (max-width: 640px){
  .title{
    transform: translateY(-6px) !important;
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: title translateY -7px ONLY === */
@media (max-width: 640px){
  .title{
    transform: translateY(-7px) !important;
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE FORCE PATCH: move TITLE using margin-bottom of logo === */
@media (max-width: 640px){
  /* do NOT move logo position, only reduce space below it */
  .brand-logo{
    margin-bottom: -14px !important; /* pull title closer DOWN from logo */
  }
}
/* === END MOBILE FORCE PATCH === */



/* === MOBILE FINAL PATCH: CONFIRM logo margin-bottom -14px ONLY === */
@media (max-width: 640px){
  .brand-logo{
    margin-bottom: -14px !important; /* CONFIRMED */
  }
}
/* === END MOBILE FINAL PATCH === */



/* === MOBILE ABSOLUTE FIX: FORCE TITLE DOWN (NO OTHER MOVE) === */
@media (max-width: 640px){

  /* remove flex gap that blocks movement */
  .topbar-inner{
    gap: 0 !important;
  }

  /* force title down visually */
  .title{
    position: relative !important;
    top: 14px !important;   /* MOVE DOWN */
  }
}
/* === END MOBILE ABSOLUTE FIX === */



/* === MOBILE FINAL VISUAL FIX: title clearly BELOW logo === */
@media (max-width: 640px){

  /* keep header structure */
  .topbar-inner{
    gap: 0 !important;
  }

  /* push title DOWN so it never overlaps logo */
  .title{
    position: relative !important;
    top: 28px !important;   /* visibly lower */
  }
}
/* === END MOBILE FINAL VISUAL FIX === */



/* === MOBILE PATCH: logo size 130px ONLY === */
@media (max-width: 640px){
  .brand-logo{
    height: 130px !important; /* requested */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: move title down + white rectangular header background === */
@media (max-width: 640px){

  /* White rectangular background for header (no radius) */
  .topbar{
    background:#ffffff !important;
  }

  .topbar-inner{
    background:#ffffff !important;
    border-radius:0 !important;        /* 4 เหลี่ยม */
    padding-bottom:24px !important;    /* ให้พื้นหลังคลุมหัวข้อ */
  }

  /* Move title down (under logo, clearer spacing) */
  .title{
    position: relative !important;
    top: 36px !important;              /* ลงมาเพิ่ม */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: move title down to 44px ONLY === */
@media (max-width: 640px){
  .title{
    position: relative !important;
    top: 44px !important; /* requested */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: move title down to 46px ONLY === */
@media (max-width: 640px){
  .title{
    position: relative !important;
    top: 46px !important; /* requested */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: title down 50px + fix text clipping === */
@media (max-width: 640px){

  .title{
    position: relative !important;
    top: 50px !important;          /* requested */
    line-height: 1.25 !important;  /* prevent text cut */
    padding-bottom: 6px !important;
    overflow: visible !important;  /* ensure no clipping */
  }

  /* ensure white header is tall enough */
  .topbar-inner{
    padding-bottom: 36px !important;
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: header white bg full width (flush left/right) === */
@media (max-width: 640px){

  /* make header background stretch edge-to-edge */
  .topbar{
    padding-left: 0 !important;
    padding-right: 0 !important;
  }

  .topbar-inner{
    margin-left: 0 !important;
    margin-right: 0 !important;
    max-width: 100% !important;
    width: 100% !important;
    padding-left: 16px !important;   /* inner safe padding */
    padding-right: 16px !important;
    border-radius: 0 !important;     /* keep rectangle */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: remove BODY side padding so top white header is flush === */
@media (max-width: 640px){
  body{
    padding-left: 0 !important;
    padding-right: 0 !important;
  }
  .topbar{
    width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }
  .topbar-inner{
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 !important;
    border-radius: 0 !important; /* 4 เหลี่ยม */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: filters buttons smaller text, centered, auto width === */
@media (max-width: 640px){

  .filters{
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 8px !important;
    justify-content: center !important; /* center buttons */
  }

  .filters select,
  .filters input,
  .filters button{
    font-size: 14px !important;          /* smaller text */
    height: 44px !important;
    padding: 0 18px !important;
    width: auto !important;              /* fit text */
    min-width: unset !important;
    text-align: center !important;
    border-radius: 999px !important;     /* pill */
    white-space: nowrap !important;
  }

  /* dropdown arrow spacing stays nice */
  .filters select{
    padding-right: 40px !important;
    background-position: right 14px center !important;
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE HARD SIZE FIX (iOS): force real control height/width === */
@media (max-width: 640px){
  .filters{
    display:flex !important;
    flex-direction:column !important;
    align-items:center !important;
    gap:12px !important;
  }

  #filterGroup, #filterCourse, #filterMonth, #filterStatus, #filterMonthYear, #search{
    width: 320px !important;
    max-width: calc(100vw - 64px) !important; /* safe on small phones */
    height: 46px !important;
    min-height: 46px !important;
    max-height: 46px !important;

    padding: 0 16px !important;
    padding-top: 0 !important;
    padding-bottom: 0 !important;

    font-size: 14px !important;
    line-height: 46px !important;

    border-radius: 16px !important;
    box-sizing: border-box !important;

    overflow: hidden !important;
    background-clip: padding-box !important;
  }

  /* iOS select quirks */
  #filterGroup, #filterCourse, #filterMonth, #filterStatus{
    -webkit-appearance: none !important;
    appearance: none !important;
    padding-right: 44px !important;
    background-position: right 14px center !important;
    background-repeat: no-repeat !important;
  }

  /* Month input & search input: avoid text clipping */
  #filterMonthYear, #search{
    line-height: normal !important;
  }

  /* Reload button like reference */
  #reload{
    width: 96px !important;
    height: 40px !important;
    min-height: 40px !important;
    max-height: 40px !important;
    padding: 0 18px !important;
    font-size: 14px !important;
    border-radius: 999px !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
  }
}
/* === END MOBILE HARD SIZE FIX === */



/* === MOBILE PATCH: move logo + title UP slightly === */
@media (max-width: 640px){

  /* move whole header block up */
  .topbar{
    padding-top: 8px !important;   /* reduce top space */
  }

  .topbar-inner{
    margin-top: -10px !important;  /* pull logo+title up */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: cut top white header box by 10px === */
@media (max-width: 640px){

  /* reduce white header height */
  .topbar{
    padding-top: 0 !important;
  }

  .topbar-inner{
    margin-top: -10px !important;  /* cut 10px from top white box */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: cut top white header box additional 10px (TOTAL 20px) === */
@media (max-width: 640px){
  .topbar{
    padding-top: 0 !important;
  }
  .topbar-inner{
    margin-top: -20px !important; /* total cut 20px */
  }
}
/* === END MOBILE PATCH === */



/* === MOBILE PATCH: cut top white header box additional 5px (TOTAL 25px) === */
@media (max-width: 640px){
  .topbar-inner{
    margin-top: -25px !important; /* total cut 25px */
  }
}
/* === END MOBILE PATCH === */


/* === Mobile: block landscape usage (force portrait) === */
@media screen and (orientation: landscape) and (max-width: 900px){
  body{ overflow: hidden !important; }
  body::before{
    content:"กรุณาหมุนหน้าจอเป็นแนวตั้ง";
    position:fixed;
    inset:0;
    background:#fff4e8;
    color:#1f2937;
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    font-size:18px;
    font-weight:700;
    z-index:99999;
    padding:24px;
  }
}


/* === Table scroll indicator (mobile-friendly) === */
.tablewrap{ padding-bottom: 10px; }
.scroll-indicator{
  position: sticky;
  bottom: 0;
  left: 0;
  height: 6px;
  background: rgba(17,24,39,0.08);
  border-radius: 999px;
  margin: 10px 12px 12px;
  overflow: hidden;
  z-index: 5;
}
.scroll-thumb{
  height: 100%;
  width: 30%;
  background: rgba(249,115,22,0.75);
  border-radius: 999px;
  transform: translateX(0);
}

/* Left/Right fade hint that table is scrollable */
.tablewrap::before,
.tablewrap::after{
  content:"";
  position:absolute;
  top:0;
  bottom:0;
  width:18px;
  pointer-events:none;
  z-index:4;
}
.tablewrap::before{
  left:0;
  background: linear-gradient(90deg, rgba(255,244,232,1), rgba(255,244,232,0));
}
.tablewrap::after{
  right:0;
  background: linear-gradient(270deg, rgba(255,244,232,1), rgba(255,244,232,0));
}

/* Make scrollbars visible (where supported) */
.tablewrap::-webkit-scrollbar{ height: 12px; width: 12px; }
.tablewrap::-webkit-scrollbar-thumb{ background: rgba(249,115,22,0.55); border-radius: 999px; }
.tablewrap::-webkit-scrollbar-track{ background: rgba(17,24,39,0.06); border-radius: 999px; }


/* === PATCH v5 (Android): shrink filter frame slightly + center (no logic changes) === */
@media (max-width: 640px){
  .filters{
    width: calc(100% - 36px) !important;   /* ลดความกว้างกรอบลงเล็กน้อย */
    margin-left: auto !important;
    margin-right: auto !important;
    box-sizing: border-box !important;
  }
}
/* === END PATCH v5 === */

</style>

<style>
/* FIX: Remove table header top line on DESKTOP only (do not touch other logic) */
@media (min-width: 901px){
  table thead th{
    border-top: none !important;
    box-shadow: none !important;
  }
}
</style>


<style>
/* FIX v7: Remove desktop-only orange divider line above table header */
@media (min-width: 901px){
  hr,
  .divider,
  .table-divider,
  .orange-divider,
  .result-divider{
    display: none !important;
    height: 0 !important;
    margin: 0 !important;
    border: 0 !important;
  }

  /* Also ensure no pseudo lines remain */
  .result-table,
  .result-table thead,
  .result-table thead tr{
    box-shadow: none !important;
  }
}
</style>


<style>
/* FIX v8: The orange "line" is the scroll indicator above the table header.
   Hide it on DESKTOP only (keep on mobile). */
@media (min-width: 901px){
  .scroll-indicator{ display:none !important; }
}
</style>


<style>
/* FIX v9: Android only – reduce filter card width & center it (no other code touched) */
@media (max-width: 900px){
  .filter-container,
  .filters,
  .filter-card{
    width: calc(100% - 24px) !important;
    margin-left: auto !important;
    margin-right: auto !important;
  }
}
</style>


<style>
/* FIX v10: Android ultra-fine tune (6px) – center filter card precisely */
@media (max-width: 900px){
  .filter-container,
  .filters,
  .filter-card{
    width: calc(100% - 12px) !important; /* ลดข้างละ ~6px */
    padding-left: 6px !important;
    padding-right: 6px !important;
    margin-left: auto !important;
    margin-right: auto !important;
    box-sizing: border-box !important;
  }
}
</style>


<style>
/* FIX v12: Keep Search button on the same row (desktop + mobile) */
.filter-row,
.filters,
.filter-container{
  display: flex !important;
  flex-wrap: wrap !important;
  align-items: center !important;
}

.filters button,
.filters .btn-search,
#searchBtn{
  margin-top: 0 !important;
}

@media (max-width: 900px){
  .filters{
    gap: 8px;
  }
}
</style>


<style>
/* FIX v13: FORCE search button inline in the SAME ROW (override grid/blocks) */
.filters{
  display: flex !important;
  flex-wrap: nowrap !important; /* ห้ามแตกบรรทัด */
  align-items: center !important;
  overflow-x: auto; /* ถ้าแคบ ให้เลื่อนแทน */
}

.filters > *{
  flex: 0 0 auto !important; /* ทุกตัวไม่ยืด */
}

.filters button,
#searchBtn{
  display: inline-flex !important;
  align-items: center !important;
  width: auto !important;
  white-space: nowrap !important;
}
</style>


<style>
/* FIX v14 */

/* ===== Desktop: all filters + search in ONE ROW ===== */
@media (min-width: 901px){
  .filters{
    display: flex !important;
    flex-wrap: nowrap !important;
    align-items: center !important;
    gap: 8px;
  }
  .filters > *{
    flex: 0 0 auto !important;
  }
}

/* ===== Mobile: Year + Month in the SAME ROW ===== */
@media (max-width: 900px){
  .filters{
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 8px;
  }

  /* กลุ่ม + หลักสูตร เต็มแถว */
  #filterGroup,
  #filterCourse{
    width: 100% !important;
  }

  /* ปี + เดือน อยู่แถวเดียวกัน */
  #filterYear,
  #filterMonth{
    width: calc(50% - 4px) !important;
  }

  /* สถานะ + ค้นหา เต็มแถว */
  #filterStatus,
  #searchBtn{
    width: 100% !important;
  }
}
</style>


<style>
/* FIX v15 */

/* ===== Desktop: keep one row, but hide the scrollbar (still scrollable) ===== */
@media (min-width: 901px){
  .filters{
    overflow-x: auto !important;
    scrollbar-width: none;          /* Firefox */
  }
  .filters::-webkit-scrollbar{
    height: 0 !important;           /* Chrome/Safari/Edge */
  }
}

/* ===== Mobile: use GRID so Year + Month are guaranteed on the same row ===== */
@media (max-width: 900px){
  .filters{
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 10px !important;
    align-items: center !important;
  }

  /* Row 1-2: full width */
  #filterGroup{ grid-column: 1 / -1 !important; }
  #filterCourse{ grid-column: 1 / -1 !important; }

  /* Row 3: Year (left) + Month (right) */
  #filterYear{ grid-column: 1 / 2 !important; }
  #filterMonth{ grid-column: 2 / 3 !important; }

  /* Row 4-5: full width */
  #filterStatus{ grid-column: 1 / -1 !important; }
  #searchBtn,
  .btn-search,
  input[type="search"]{
    grid-column: 1 / -1 !important;
  }

  /* Ensure selects don't stretch weirdly */
  .filters select,
  .filters input,
  .filters button{
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 !important;
    box-sizing: border-box !important;
  }
}
</style>


<style>
/* FIX v16 */

/* ===== Desktop: prevent Search from falling out + make Year 50% narrower ===== */
@media (min-width: 901px){
  /* keep one row */
  .filters{
    display: flex !important;
    flex-wrap: nowrap !important;
    align-items: center !important;
    gap: 8px !important;
    overflow-x: auto !important;
    max-width: 100% !important;
  }
  /* Year narrower */
  #filterYear{
    width: 120px !important;          /* ~50% narrower than others */
    min-width: 120px !important;
  }
  /* Search input must not overflow */
  #searchBtn,
  .btn-search,
  input[type="search"]{
    min-width: 220px !important;
    max-width: 320px !important;
    flex: 1 1 260px !important;       /* allow shrink/grow to fit */
  }
}

/* ===== Mobile: Month not overflow + center all controls ===== */
@media (max-width: 900px){
  .filters{
    justify-items: center !important;  /* grid items center */
    justify-content: center !important;
  }
  .filters select,
  .filters input,
  .filters button{
    width: 100% !important;
    max-width: 100% !important;
    margin-left: auto !important;
    margin-right: auto !important;
    box-sizing: border-box !important;
  }
  /* extra safety: prevent month control from exceeding */
  #filterMonth{
    max-width: 100% !important;
  }
}
</style>


<style>
/* FIX v17: Ensure Mobile Year+Month in the same row reliably (wrapper) */
@media (min-width: 901px){
  .ym-row{ display: contents !important; } /* keep desktop one-row layout */
}
@media (max-width: 900px){
  .ym-row{
    display: flex !important;
    gap: 10px !important;
    width: 100% !important;
    justify-content: center !important;
  }
  .ym-row > #filterYear,
  .ym-row > #filterMonth{
    flex: 1 1 0 !important;
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    margin: 0 !important;
  }
}
</style>


<style>
/* FIX v18 */

/* ===== Desktop: keep all filters in one row, prevent search overflow, shrink Year ===== */
@media (min-width: 901px){
  .filters{
    display:flex !important;
    flex-wrap:nowrap !important;
    align-items:center !important;
    gap:8px !important;
    max-width:100% !important;
    overflow:hidden !important;  /* ไม่ให้ล้นกรอบขวา */
  }
  .filters > *{ min-width:0 !important; } /* ให้ flex ย่อได้จริง */

  #filterYear{
    width: 90px !important;
    min-width: 90px !important;
  }

  /* ช่องค้นหา */
  #search{
    flex: 1 1 220px !important;
    min-width: 160px !important;
    max-width: 260px !important;
    width: auto !important;
  }
}

/* ===== Mobile: override old grid/flex conflicts -> stable stack + Year/Month same row ===== */
@media (max-width: 900px){
  /* บังคับให้ filters ไม่ใช้ grid เดิม */
  .filters{
    display:block !important;
  }
  .filters > select,
  .filters > input{
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    margin: 10px auto !important;
  }
  .ym-row{
    display:flex !important;
    gap:10px !important;
    width:100% !important;
    margin:10px auto !important;
  }
  .ym-row #filterYear,
  .ym-row #filterMonth{
    flex: 1 1 0 !important;
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    margin: 0 !important;
  }
}
</style>


<style>
/* FIX v19 */

/* ===== Desktop ===== */
@media (min-width: 901px){
  /* ปี เล็กลงอีก */
  #filterYear{
    width: 70px !important;
    min-width: 70px !important;
    padding-left: 10px !important;
    padding-right: 10px !important;
  }

  /* ค้นหา กว้างขึ้น */
  #search{
    flex: 1 1 320px !important;
    min-width: 280px !important;
    max-width: 420px !important;
  }
}

/* ===== Mobile: ทุกปุ่มกว้างเท่ากัน ===== */
@media (max-width: 900px){
  .filters{
    display: block !important;
  }

  .filters select,
  .filters input{
    width: 92% !important;     /* เท่ากันทุกปุ่ม */
    max-width: 92% !important;
    margin: 10px auto !important;
    box-sizing: border-box !important;
  }

  /* ปี + เดือน แถวเดียว แต่กว้างเท่ากับปุ่มอื่น */
  .ym-row{
    display: flex !important;
    gap: 8px !important;
    width: 92% !important;
    margin: 10px auto !important;
  }
  .ym-row select{
    flex: 1 1 0 !important;
    width: 100% !important;
  }
}
</style>


<style>
/* FIX v20 */

/* ===== Desktop: Year smaller, Search wider but NEVER overflow right ===== */
@media (min-width: 901px){
  .filters{
    display:flex !important;
    flex-wrap:nowrap !important;
    align-items:center !important;
    gap:8px !important;
    max-width:100% !important;
    overflow:hidden !important;            /* ห้ามล้นกรอบขวา */
    padding-right: 8px !important;        /* กันชน */
    box-sizing: border-box !important;
  }
  .filters > *{ min-width:0 !important; }

  #filterYear{
    width: 60px !important;
    min-width: 60px !important;
    padding-left: 8px !important;
    padding-right: 8px !important;
  }

  /* ช่องค้นหา: ให้กว้างขึ้นแต่ย่อได้ตามพื้นที่ */
  #search{
    flex: 1 1 0 !important;               /* ใช้พื้นที่ที่เหลือ */
    min-width: 260px !important;
    max-width: 520px !important;          /* กว้างขึ้น แต่ไม่เกิน */
    width: auto !important;
  }
}

/* ===== Mobile: Year look same as Month, Search same width as Status ===== */
@media (max-width: 900px){
  /* ให้ Year+Month เหมือนกันทุกอย่าง */
  .ym-row select{
    height: 56px !important;
    border-radius: 28px !important;
    padding-left: 18px !important;
    padding-right: 18px !important;
    box-sizing: border-box !important;
  }

  /* ให้ input ค้นหา สูง/ทรงเท่ากับ select สถานะ */
  #search{
    width: 92% !important;     /* เท่ากับสถานะ (ที่ตั้งไว้ 92%) */
    max-width: 92% !important;
    height: 56px !important;
    border-radius: 28px !important;
    margin: 10px auto !important;
    box-sizing: border-box !important;
  }
}
</style>


<style>
/* FIX v21: Force overrides that actually win (inline + previous !important) */

/* ===== Desktop: one row, no right overflow; Year smaller; Search wider ===== */
@media (min-width: 901px){
  .filters{
    display:flex !important;
    flex-wrap:nowrap !important;
    align-items:center !important;
    gap:10px !important;
    max-width:100% !important;
    overflow-x:auto !important;      /* ถ้าแน่นมาก ให้เลื่อนแทน ไม่ล้นขวา */
    overflow-y:hidden !important;
    scrollbar-width:none;            /* Firefox hide bar */
    box-sizing:border-box !important;
  }
  .filters::-webkit-scrollbar{ height:0 !important; }

  /* ช่วยให้ input ย่อได้จริง */
  .filters > *{ min-width:0 !important; }

  /* ให้ dropdown หลักๆ มีขนาดคงที่เพื่อไม่กินพื้นที่ search จนหลุด */
  #filterGroup{ flex:0 0 240px !important; max-width:240px !important; }
  #filterCourse{ flex:0 0 240px !important; max-width:240px !important; }
  #filterMonth{ flex:0 0 180px !important; max-width:180px !important; }
  #filterStatus{ flex:0 0 180px !important; max-width:180px !important; }

  /* ปี เล็กลง */
  #filterYear{
    flex:0 0 80px !important;
    width:80px !important;
    max-width:80px !important;
  }

  /* ค้นหา: กว้างขึ้น แต่ไม่หลุด (ย่อได้เมื่อพื้นที่น้อย) */
  #search{
    flex:1 1 360px !important;
    min-width:260px !important;
    max-width:520px !important;
    width:auto !important; /* override inline width */
  }
}

/* ===== Mobile: Year looks EXACTLY like Month; Search width equals Status ===== */
@media (max-width: 900px){
  /* ให้ 2 ปุ่มนี้เหมือนกัน 100% */
  .ym-row > #filterYear,
  .ym-row > #filterMonth{
    width:100% !important;
    height:56px !important;
    border-radius:28px !important;
    padding-left:18px !important;
    padding-right:18px !important;
    box-sizing:border-box !important;
    margin:0 !important;
  }

  /* ให้ค้นหาเท่ากับสถานะ (ใช้ width เดียวกัน) */
  .filters #filterStatus,
  .filters #search{
    width:92% !important;
    max-width:92% !important;
    height:56px !important;
    border-radius:28px !important;
    margin:10px auto !important;
    box-sizing:border-box !important;
  }
}
</style>


<style>
/* FIX v22 */

/* ===== Desktop ===== */
@media (min-width: 901px){
  /* ปี: ยาวขึ้นอีกนิด */
  #filterYear{
    flex: 0 0 110px !important;
    width: 110px !important;
    max-width: 110px !important;
  }
}

/* ===== Mobile ===== */
@media (max-width: 900px){
  /* ปี = เดือน (ขนาดเดียวกัน) */
  .ym-row > #filterYear,
  .ym-row > #filterMonth{
    width: 100% !important;
    height: 56px !important;
    border-radius: 28px !important;
    padding-left: 18px !important;
    padding-right: 18px !important;
    box-sizing: border-box !important;
  }

  /* สถานะ + ค้นหา = หลักสูตร */
  #filterCourse,
  #filterStatus,
  #search{
    width: 92% !important;
    max-width: 92% !important;
    height: 56px !important;
    border-radius: 28px !important;
    margin: 10px auto !important;
    box-sizing: border-box !important;
  }
}
</style>


<style>
/* FIX v23 */

/* ===== Desktop ===== */
@media (min-width: 901px){
  /* ปี = 140px */
  #filterYear{
    flex: 0 0 140px !important;
    width: 140px !important;
    max-width: 140px !important;
  }
}

/* ===== Mobile ===== */
@media (max-width: 900px){
  /* หลักสูตร / สถานะ / ค้นหา = กลุ่มผู้เข้าอบรม */
  #filterGroup,
  #filterCourse,
  #filterStatus,
  #search{
    width: 92% !important;
    max-width: 92% !important;
    height: 56px !important;
    border-radius: 28px !important;
    margin: 10px auto !important;
    box-sizing: border-box !important;
  }

  /* ปี = เดือน */
  .ym-row > #filterYear,
  .ym-row > #filterMonth{
    width: 100% !important;
    height: 56px !important;
    border-radius: 28px !important;
    padding-left: 18px !important;
    padding-right: 18px !important;
    box-sizing: border-box !important;
    margin: 0 !important;
  }
}
</style>


<style>
/* FIX v24 */

/* ===== Desktop: Course fits content; Search a bit smaller ===== */
@media (min-width: 901px){
  /* allow Course to size by its content (but cap so it won't eat the row) */
  #filterCourse{
    flex: 0 1 auto !important;
    width: max-content !important;
    max-width: 320px !important;
    min-width: 220px !important;
  }

  /* Search smaller a bit */
  #search{
    flex: 1 1 260px !important;
    min-width: 220px !important;
    max-width: 380px !important;
  }
}

/* ===== Mobile: force Year = Month width exactly ===== */
@media (max-width: 900px){
  .ym-row{
    width: 92% !important;
    margin: 10px auto !important;
  }
  .filters .ym-row > #filterYear,
  .filters .ym-row > #filterMonth{
    flex: 1 1 0 !important;
    min-width: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
  }
}
</style>


<style>
/* FIX v25 */

/* ===== Desktop: Group + Course compact like screenshot; Search never overflow right ===== */
@media (min-width: 901px){
  .filters{
    overflow-x: hidden !important;   /* ห้ามล้นกรอบขวา */
    max-width: 100% !important;
    box-sizing: border-box !important;
  }

  /* กลุ่มผู้เข้าอบรม + หลักสูตร ให้กว้างตามข้อความ แต่ไม่ยาวเกิน */
  #filterGroup,
  #filterCourse{
    flex: 0 1 auto !important;
    width: max-content !important;
    max-width: 320px !important;
    min-width: 260px !important;     /* ให้ได้ทรงเหมือนภาพ */
  }

  /* ค้นหา: ย่อให้ไม่หลุดกรอบขวา */
  #search{
    flex: 1 1 220px !important;
    min-width: 200px !important;
    max-width: 300px !important;
  }
}

/* ===== Mobile: Year = Month (equal width 50/50) ===== */
@media (max-width: 900px){
  .ym-row{
    width: 92% !important;
    margin: 10px auto !important;
    display: flex !important;
    gap: 8px !important;
  }

  .ym-row > #filterYear,
  .ym-row > #filterMonth{
    flex: 1 1 0 !important;
    width: 0 !important;            /* trick: equalize widths */
    min-width: 0 !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
  }
}
</style>


<style>
/* FIX v26: ultra-specific overrides (wins over previous !important) */

/* ===== Desktop ===== */
@media (min-width: 901px){
  .filters{
    display:flex !important;
    flex-wrap:nowrap !important;
    align-items:center !important;
    gap:10px !important;
    max-width:100% !important;
    overflow-x:auto !important;           /* ถ้าแน่น -> เลื่อนในแถว ไม่ล้นขวา */
    overflow-y:hidden !important;
    scrollbar-width:none !important;
    padding-right:12px !important;
    box-sizing:border-box !important;
  }
  .filters::-webkit-scrollbar{ height:0 !important; }

  /* Group + Course: compact like screenshot */
  .filters select#filterGroup,
  .filters select#filterCourse{
    flex: 0 1 auto !important;
    flex-basis: auto !important;
    width: auto !important;
    max-width: 280px !important;
    min-width: 240px !important;
  }

  /* Year: smaller (but readable) */
  .filters select#filterYear{
    flex: 0 0 140px !important;   /* user wants 140px */
    width: 140px !important;
    max-width: 140px !important;
  }

  /* Month/Status fixed */
  .filters select#filterMonth,
  .filters select#filterStatus{
    flex: 0 0 180px !important;
    width: 180px !important;
    max-width: 180px !important;
  }

  /* Search: smaller so it won't push outside */
  .filters input#search{
    flex: 0 1 240px !important;
    width: 240px !important;
    max-width: 260px !important;
    min-width: 200px !important;
  }
}

/* ===== Mobile: Force Year == Month width and same visual size ===== */
@media (max-width: 900px){
  .filters .ym-row{
    width: 92% !important;
    margin: 10px auto !important;
    display:flex !important;
    gap:8px !important;
    box-sizing:border-box !important;
  }
  .filters .ym-row > select#filterYear,
  .filters .ym-row > select#filterMonth{
    flex: 1 1 0 !important;
    width: 0 !important;               /* equal split */
    min-width: 0 !important;
    max-width: 100% !important;
    height: 56px !important;
    border-radius: 28px !important;
    box-sizing: border-box !important;
  }
}
</style>


<style>
/* FIX v27 */

/* ===== Desktop: Course longer, Search ends exactly at right edge ===== */
@media (min-width: 901px){
  .filters{
    display:flex !important;
    flex-wrap:nowrap !important;
    align-items:center !important;
    gap:10px !important;
    max-width:100% !important;
    overflow:hidden !important;      /* ห้ามล้นขวา */
    padding-right:0 !important;
    box-sizing:border-box !important;
  }
  .filters > *{ min-width:0 !important; }

  /* Group: fixed-ish */
  .filters select#filterGroup{
    flex: 0 0 260px !important;
    width: 260px !important;
    max-width: 260px !important;
  }

  /* Course: take remaining space (longer) but keep sensible caps */
  .filters select#filterCourse{
    flex: 1 1 auto !important;       /* ยืดให้ยาวขึ้น */
    width: auto !important;
    min-width: 320px !important;
    max-width: 520px !important;
  }

  /* Year (140px) */
  .filters select#filterYear{
    flex: 0 0 140px !important;
    width: 140px !important;
    max-width: 140px !important;
  }

  /* Month/Status */
  .filters select#filterMonth,
  .filters select#filterStatus{
    flex: 0 0 180px !important;
    width: 180px !important;
    max-width: 180px !important;
  }

  /* Search: fixed width, never pushes outside; stays at far right */
  .filters input#search{
    flex: 0 0 260px !important;
    width: 260px !important;
    max-width: 260px !important;
    min-width: 260px !important;
    margin-left: auto !important;    /* ชิดขวาสุด */
  }
}

/* ===== Mobile: FORCE Year == Month (wins everything) ===== */
@media (max-width: 900px){
  /* Make sure filters are not grid from old CSS */
  .filters{
    display:block !important;
  }

  /* Ensure the wrapper exists and is 92% like others */
  .filters .ym-row{
    width: 92% !important;
    margin: 10px auto !important;
    display:flex !important;
    gap: 8px !important;
    box-sizing:border-box !important;
  }

  /* Equal split 50/50, identical visual */
  html body .filters .ym-row > select#filterYear,
  html body .filters .ym-row > select#filterMonth{
    flex: 1 1 0 !important;
    width: 0 !important;
    min-width: 0 !important;
    max-width: 100% !important;
    height: 56px !important;
    border-radius: 28px !important;
    padding-left: 18px !important;
    padding-right: 18px !important;
    box-sizing: border-box !important;
    margin: 0 !important;
  }
}
</style>


<style>
/* FIX v28 */

/* ===== Desktop: add right spacing so Search isn't too close to orange border ===== */
@media (min-width: 901px){
  .filters{
    padding-left: 12px !important;
    padding-right: 12px !important;   /* ระยะห่างเท่าฝั่งซ้าย */
    box-sizing: border-box !important;
  }
  .filters input#search{
    margin-right: 0 !important;       /* กันบาง CSS เดิม */
  }
}

/* ===== Mobile: FORCE Year/Month equal size + same row using floats (works even if wrappers fail) ===== */
@media (max-width: 900px){
  /* reset any previous layout that fights us */
  #filterYear, #filterMonth{
    height: 56px !important;
    border-radius: 28px !important;
    padding-left: 18px !important;
    padding-right: 18px !important;
    box-sizing: border-box !important;
  }

  /* make them 50/50 and sit same row */
  #filterYear{
    float: left !important;
    width: calc(46% - 4px) !important;   /* เท่ากันกับเดือน */
    margin-left: 4% !important;          /* ให้กึ่งกลางเหมือนปุ่มอื่น (92% total) */
    margin-right: 8px !important;
  }
  #filterMonth{
    float: left !important;
    width: calc(46% - 4px) !important;
    margin-right: 4% !important;
  }

  /* clear floats so next controls don't overlap */
  .filters::after{
    content: "" !important;
    display: block !important;
    clear: both !important;
  }
}
</style>


<style>
/* FIX v30: Mobile Year+Month forced 50/50 in same row (no placeholders, no JS touched) */
@media (min-width: 901px){
  .mobile-ym-row{ display: contents !important; } /* desktop unchanged */
}
@media (max-width: 900px){
  .mobile-ym-row{
    width: 92% !important;
    margin: 10px auto !important;
    display: flex !important;
    gap: 8px !important;
    box-sizing: border-box !important;
  }
  .mobile-ym-row > select#filterYear,
  .mobile-ym-row > select#filterMonth{
    flex: 1 1 0 !important;
    width: 0 !important;              /* equal split */
    min-width: 0 !important;
    max-width: 100% !important;
    height: 56px !important;
    border-radius: 28px !important;
    padding-left: 18px !important;
    padding-right: 18px !important;
    box-sizing: border-box !important;
    margin: 0 !important;
  }
}

/* --- MOBILE FIX: year/month row + font/line-height (v30 mobile font16 fix) --- */
@media (max-width: 900px){
  .mobile-ym-row{
    display:flex !important;
    gap:14px !important;
    width:100% !important;
    align-items:stretch !important;
    margin-top:14px !important;
  }
  .mobile-ym-row > select{
    flex:1 1 0 !important;
    min-width:0 !important;
    width:100% !important;
    box-sizing:border-box !important;
  }
  /* force month visible (some older rules hide it) */
  #filterMonth{ display:block !important; visibility:visible !important; opacity:1 !important; }
  #filterYear{ display:block !important; visibility:visible !important; opacity:1 !important; }

  /* Make ALL filter controls same typography and prevent Thai tone marks being cut */
  .filters .select-btn,
  .filters select,
  .filters input[type="text"],
  .filters input{
    font-size:16px !important;
    line-height:1.4 !important;
    padding-top:14px !important;
    padding-bottom:14px !important;
    height:auto !important;
  }
}

</style>


<style>
/* v48: NATIVE selects (clickable) + Year=Month exact grid + center all controls (mobile only) */
@media (max-width: 900px){
  /* Center all filter controls like the Year/Month row */
  #filterGroup, #filterCourse, #filterStatus, #search, .ym-row{
    display: block !important;
    margin-left: auto !important;
    margin-right: auto !important;
  }

  /* Match pill size */
  #filterGroup, #filterCourse, #filterStatus, #search, #filterYear, #filterMonth{
    height: 56px !important;
    border-radius: 28px !important;
    box-sizing: border-box !important;
  }

  /* Year/Month: exact equal widths */
  .ym-row{
    width: 100% !important;
    display: grid !important;
    grid-template-columns: minmax(0,1fr) minmax(0,1fr) !important;
    gap: 12px !important;
  }
  .ym-row #filterYear, .ym-row #filterMonth{
    width: 100% !important;
    min-width: 0 !important;
    max-width: 100% !important;
    padding-left: 18px !important;
    padding-right: 40px !important; /* reserve arrow space equally */
  }

  /* Keep other selects consistent */
  #filterGroup, #filterCourse, #filterStatus{
    width: 100% !important;
    padding-left: 18px !important;
    padding-right: 40px !important;
  }
  /* Search input */
  #search{
    width: 100% !important;
    padding-left: 18px !important;
    padding-right: 18px !important;
  }
}
</style>


<style>
/* v49: FORCE Year = Month EXACT (native select, mobile) */
@media (max-width: 900px){
  .ym-row{
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 12px !important;
    width: 100% !important;
  }

  .ym-row select{
    width: 100% !important;
    min-width: 0 !important;
    max-width: 100% !important;
    height: 56px !important;
    border-radius: 28px !important;
    padding-left: 18px !important;
    padding-right: 40px !important; /* arrow space equal */
    box-sizing: border-box !important;
    appearance: none !important;
    -webkit-appearance: none !important;
    background-position: right 16px center !important;
  }
}
</style>


<style>
/* v50: Visual EXACT match Year = Month (native select, mobile) */
@media (max-width: 900px){
  .ym-row select{
    font-size: 16px !important;
    font-weight: 500 !important;
    letter-spacing: 0 !important;
    text-align: left !important;
    text-indent: 0 !important;
    color: #1f3a8a !important; /* same as others */
    background-color: #fff !important;
  }
}
</style>


<style>
/* v52 FINAL: Year = Month EXACT (width, height, font) from v50 */
@media (max-width: 900px){
  .ym-row{
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 12px !important;
    width: 100% !important;
  }

  #filterYear,
  #filterMonth{
    width: 100% !important;
    min-width: 0 !important;
    max-width: 100% !important;

    height: 56px !important;
    min-height: 56px !important;
    max-height: 56px !important;

    font-size: 16px !important;
    font-weight: 500 !important;
    line-height: 56px !important;
    letter-spacing: 0 !important;

    padding-left: 18px !important;
    padding-right: 40px !important;

    border-radius: 28px !important;
    box-sizing: border-box !important;

    appearance: none !important;
    -webkit-appearance: none !important;
    background-position: right 16px center !important;
  }
}
</style>


<style>
/* v53 FIX: Prevent Year text clipping on iOS native select */
@media (max-width: 900px){
  #filterYear,
  #filterMonth{
    line-height: normal !important;   /* let iOS manage text vertically */
    padding-top: 0 !important;
    padding-bottom: 0 !important;
  }
}
</style>


<style>
/* v55: Match Year/Month font-size to Course (Course uses 14px on mobile in this file) */
@media (max-width: 900px){
  /* keep Year/Month equal size (width/height/padding/arrow) */
  .ym-row{
    display:grid !important;
    grid-template-columns:1fr 1fr !important;
    gap:12px !important;
    width:100% !important;
  }
  #filterYear, #filterMonth{
    width:100% !important;
    min-width:0 !important;
    max-width:100% !important;
    height:56px !important;
    border-radius:28px !important;
    padding-left:18px !important;
    padding-right:40px !important;
    box-sizing:border-box !important;
    appearance:none !important;
    -webkit-appearance:none !important;
    background-position:right 16px center !important;

    /* font EXACT like Course */
    font-size:14px !important;
    font-weight:500 !important;
    line-height:normal !important; /* avoid iOS clip */
  }
}
</style>


<style>
/* v56: Make Year & Month FULL WIDTH like other buttons (mobile) */
@media (max-width: 900px){
  /* stack Year & Month vertically */
  .ym-row{
    display: block !important;
    width: 100% !important;
  }

  #filterYear,
  #filterMonth{
    width: 100% !important;
    max-width: 100% !important;
    margin-left: auto !important;
    margin-right: auto !important;
  }

  /* spacing between Year and Month same as other controls */
  #filterMonth{
    margin-top: 12px !important;
  }
}
</style>


<style>
/* v68: Normalize ALL filter controls so Year/Month cannot be taller than Course (mobile) */
@media (max-width: 900px){
  /* same width + radius for all */
  #filterGroup,
  #filterCourse,
  #filterStatus,
  #filterYear,
  #filterMonth,
  #search{
    width: 92% !important;
    max-width: 92% !important;
    margin: 10px auto !important;
    border-radius: 28px !important;
    box-sizing: border-box !important;

    /* same internal spacing = same visual height */
    padding: 14px 18px !important;
    line-height: normal !important;
    font-size: 14px !important;
    font-weight: 500 !important;
  }

  /* selects: keep dropdown arrow (no spinner) */
  #filterGroup,
  #filterCourse,
  #filterStatus,
  #filterYear,
  #filterMonth{
    appearance: none !important;
    -webkit-appearance: none !important;
    padding-right: 44px !important;      /* reserve arrow area */
    background-position: right 16px center !important;
    background-repeat: no-repeat !important;
    background-size: 12px !important;
  }

  /* Year/Month full width like others (stacked in v56 already) */
  #filterMonth{ margin-top: 10px !important; }
}
</style>


<style>
/* v69: Make ALL filter controls equal height without clipping text (mobile first, safe for iOS selects) */
@media (max-width: 900px){
  /* Base: same typography + box model for every control */
  #filterGroup,
  #filterCourse,
  #filterStatus,
  #filterYear,
  #filterMonth,
  #filterMonthYear,
  #search{
    box-sizing: border-box !important;
    font-size: 14px !important;
    font-weight: 500 !important;
    line-height: normal !important;      /* prevent iOS select text clipping */
    min-height: 56px !important;         /* equal visual height */
    padding-top: 14px !important;
    padding-bottom: 14px !important;
  }

  /* Selects: keep arrow space consistent, avoid spinner */
  #filterGroup,
  #filterCourse,
  #filterStatus,
  #filterYear,
  #filterMonth,
  #filterMonthYear{
    padding-left: 18px !important;
    padding-right: 44px !important;      /* reserve arrow area */
    appearance: none !important;
    -webkit-appearance: none !important;
    background-position: right 16px center !important;
    background-repeat: no-repeat !important;
    background-size: 12px !important;
  }

  /* Search input: no arrow space needed */
  #search{
    padding-left: 18px !important;
    padding-right: 18px !important;
  }
}
</style>


<style>
/* v72: Bold text, LEFT aligned (restore original alignment, safe for native select) */
@media (max-width: 900px){
  #filterGroup,
  #filterCourse,
  #filterStatus,
  #filterYear,
  #filterMonth,
  #search{
    font-weight: 600 !important;   /* bold */
    text-align: left !important;   /* left like original */
  }

  /* native selects: ensure default left alignment */
  #filterGroup,
  #filterCourse,
  #filterStatus,
  #filterYear,
  #filterMonth{
    text-align-last: left !important;
  }
}
</style>


<style>
/* v73: Equal vertical spacing between all filter buttons */
@media (max-width: 900px){
  /* Apply same margin-bottom to every control */
  #filterGroup,
  #filterCourse,
  #filterYear,
  #filterMonth,
  #filterStatus,
  #search{
    margin-bottom: 14px !important; /* equal spacing */
  }

  /* Remove extra margins that may exist */
  .ym-row,
  .filter-row,
  .filter-item{
    margin-bottom: 0 !important;
  }
}
</style>


<style>
/* v74: Equal vertical spacing = 10px for all filter buttons */
@media (max-width: 900px){
  #filterGroup,
  #filterCourse,
  #filterYear,
  #filterMonth,
  #filterStatus,
  #search{
    margin-bottom: 10px !important;
  }

  /* ensure no extra spacing from wrappers */
  .ym-row,
  .filter-row,
  .filter-item{
    margin-bottom: 0 !important;
  }
}
</style>


<style>
/* v75 FINAL: Equal spacing 10px everywhere (no wrapper stacking) */
@media (max-width: 900px){

  /* Single controls */
  #filterGroup,
  #filterCourse,
  #filterStatus,
  #search{
    margin-bottom: 10px !important;
  }

  /* Year/Month row counts as ONE control */
  .ym-row{
    margin-bottom: 10px !important;
    gap: 10px !important;          /* space between year & month */
  }

  /* Prevent inner margin stacking */
  #filterYear,
  #filterMonth{
    margin: 0 !important;
  }
}
</style>


<style>
/* v76: Force EXACT equal spacing using container gap (eliminate hidden wrapper margins) */
@media (max-width: 900px){

  /* One source of truth for spacing */
  .filters{
    display: flex !important;
    flex-direction: column !important;
    gap: 10px !important;
  }

  /* Remove ALL margins from children to prevent stacking */
  .filters > *{
    margin: 0 !important;
  }

  /* Year/Month wrappers must not add spacing */
  .mobile-ym-row{
    margin: 0 !important;
    padding: 0 !important;
  }
  .ym-row{
    margin: 0 !important;
    padding: 0 !important;
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 10px !important; /* space between year & month */
  }

  #filterYear,
  #filterMonth{
    margin: 0 !important;
  }
}
</style>


<style>
/* === CRITICAL FIX: Restore Year/Month usability (Desktop + Mobile) === */

/* 1) Ensure selects are clickable everywhere */
.filters select{
  pointer-events: auto !important;
  position: relative !important;
  z-index: 5 !important;
}

/* 2) Remove overlays that block clicks */
.filters::before,
.filters::after,
.filters *::before,
.filters *::after{
  pointer-events: none !important;
}

/* 3) Keep spacing + bold (mobile only) */
@media (max-width: 900px){
  .filters{ gap: 5px !important; }
  .filters > *{ margin: 0 !important; }
  .ym-row{ gap: 5px !important; margin:0 !important; padding:0 !important; }

  .filters select,
  .filters input,
  .filters button{
    font-weight: 800 !important;
  }
}
</style>

</head>

<body>

<script>
</script>
<div class="topbar">
    <div class="topbar-inner">
      <img class="brand-logo" src="data:image/png;base64,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" alt="Santa Fe">
      <h1 class="title">Training Program (โปรแกรมฝึกอบรม)</h1>
      <div class="version-badge">Version 1.0 (19.12.2025)</div>
    </div>
  </div>
  <div class="header-gap"></div>

  <div class="wrap">
    <div class="card">
      <div class="filters">
        <select id="filterGroup"><option value="">กลุ่มผู้เข้าอบรม: ทั้งหมด</option></select>
        <select id="filterCourse"><option value="">หลักสูตร: ทั้งหมด</option></select>
        <div class="mobile-ym-row">
          <div class="ym-row"><select id="filterYear" class="select-btn">
            <option value="">ปี: ทั้งหมด</option>
          </select>
          <select id="filterMonth" class="select-btn">
            <option value="">เดือน: ทั้งหมด</option>
          </select></div>
        </div>

        <!-- เก็บ input เดือน/ปี ไว้ (ซ่อนไว้) เผื่อใช้งานภายหลัง -->
        <input id="filterMonthYear" type="month" aria-label="เดือน/ปี" placeholder="เดือน/ปี" style="display:none">
<select id="filterStatus"><option value="">สถานะ: ทั้งหมด</option></select>
        <input id="search" placeholder="ค้นหา..." style="min-width:220px; flex:1;">
</div>

      <div class="notice" id="notice">กำลังโหลดข้อมูล...</div>
      <div class="error" id="errorBox"></div>

      <div class="tablewrap" id="tablewrap">
        <div class="scroll-indicator" aria-hidden="true"><div class="scroll-thumb" id="scrollThumb"></div></div>
        <table>
          <thead>
            <tr>
              <th class="col-group">กลุ่มผู้เข้าอบรม</th>
              <th class="col-course">หลักสูตร</th>
              <th class="col-batch">รุ่น</th>
              <th class="col-trainer">วิทยากร</th>
              <th class="col-date th-date">วันที่จัดอบรม</th>
              <th class="col-status th-status">สถานะ</th>
              <th class="col-link">ลิงก์ทะเบียนรายชื่อ</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>

      <div class="foot">Prepared by Operations Department, FAB Food Holding</div>
    </div>
  </div>

<script>
  const CSV_URL = "https://docs.google.com/spreadsheets/d/19H-TfJugEGEyFSIxmamPMCPf9g48UpiW_OTs2CTVoG0/gviz/tq?tqx=out:csv&sheet=%E0%B8%8A%E0%B8%B5%E0%B8%951";

  const TH_MONTH = {
    "มกราคม":1,"กุมภาพันธ์":2,"มีนาคม":3,"เมษายน":4,"พฤษภาคม":5,"มิถุนายน":6,
    "กรกฎาคม":7,"สิงหาคม":8,"กันยายน":9,"ตุลาคม":10,"พฤศจิกายน":11,"ธันวาคม":12
  };
  const TH_MONTH_REV = {
    1:"มกราคม",2:"กุมภาพันธ์",3:"มีนาคม",4:"เมษายน",5:"พฤษภาคม",6:"มิถุนายน",
    7:"กรกฎาคม",8:"สิงหาคม",9:"กันยายน",10:"ตุลาคม",11:"พฤศจิกายน",12:"ธันวาคม"
  };

  function monthKeyFromMonthInput(val){
    // val: 'YYYY-MM' (Gregorian). Convert to Thai month key used in sheet: 'เดือน พ.ศ.'
    if(!val) return "";
    const [y, m] = val.split("-").map(x=>parseInt(x,10));
    if(!y || !m) return "";
    const thMonth = TH_MONTH_REV[m] || "";
    const by = y + 543;
    return thMonth && by ? `${thMonth} ${by}` : "";
  }


  const els = {
    tbody: document.getElementById("tbody"),
    notice: document.getElementById("notice"),
    errorBox: document.getElementById("errorBox"),    fg: document.getElementById("filterGroup"),
    fs: document.getElementById("filterStatus"),
    fm: document.getElementById("filterMonth"),
    fmy: document.getElementById("filterMonthYear"),
    fc: document.getElementById("filterCourse"),
    fy: document.getElementById("filterYear"),
    q: document.getElementById("search"),
  };

  let allRows = [];
  let IDX = null;

  function parseCSV(text){
    const rows = [];
    let i=0, field="", row=[], inQuotes=false;
    while(i < text.length){
      const c = text[i];
      if (c === '"'){
        if (inQuotes && text[i+1] === '"'){ field += '"'; i++; }
        else inQuotes = !inQuotes;
      } else if (c === ',' && !inQuotes){
        row.push(field); field = "";
      } else if ((c === '\n' || c === '\r') && !inQuotes){
        if (field.length || row.length){ row.push(field); rows.push(row); }
        field = ""; row = [];
        if (c === '\r' && text[i+1] === '\n') i++;
      } else {
        field += c;
      }
      i++;
    }
    if (field.length || row.length){ row.push(field); rows.push(row); }
    return rows.map(r => r.map(x => (x ?? "").trim()));
  }

  function escapeHtml(str){
    return (str ?? "").replace(/[&<>"']/g, m => ({
      "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;"
    }[m]));
  }

  function monthKeyFromThaiDate(s){
    const parts = (s||"").trim().split(/\s+/);
    if (parts.length >= 3) return parts[1] + " " + parts[2];
    return "";
  }

  function yearFromThaiDate(s){
    const parts = (s||"").trim().split(/\s+/);
    if (parts.length >= 3) return parts[2];
    return "";
  }
  function monthFromThaiDate(s){
    const parts = (s||"").trim().split(/\s+/);
    if (parts.length >= 3) return parts[1];
    return "";
  }


  function parseThaiDate(s){
    const parts = (s||"").trim().split(/\s+/);
    if (parts.length < 3) return null;
    const d = parseInt(parts[0],10);
    const m = TH_MONTH[parts[1]];
    let y = parseInt(parts[2],10);
    if(!d || !m || !y) return null;
    // Support both Gregorian (e.g., 2026) and Thai Buddhist Era (e.g., 2566)
    if (y >= 2400) y = y - 543;
    return new Date(y, m-1, d);
  }

  function uniq(arr){ return Array.from(new Set(arr.filter(Boolean))); }

  function sortMonthKeys(keys){
    return keys.slice().sort((a,b)=>{
      const pa=a.split(" "), pb=b.split(" ");
      const ma=TH_MONTH[pa[0]]||99, mb=TH_MONTH[pb[0]]||99;
      const ya=parseInt(pa[1]||"0",10), yb=parseInt(pb[1]||"0",10);
      if(ya!==yb) return ya-yb;
      return ma-mb;
    });
  }

  // ✅ สถานะ: สีแม่นขึ้น + รองรับข้อความหลากหลาย
  function badgeClass(status){
    const t = (status||"").toLowerCase().trim();

    // Cancel first (most specific)
    if (t.includes("ยกเลิก") || t.includes("cancel")) return "b-cancel";

    // Done / Completed
    if (t.includes("อบรมเรียบร้อย") || t.includes("เรียบร้อย") || t.includes("ยืนยันแล้ว") || t.includes("ยืนยัน") ||
        t.includes("สำเร็จ") || t.includes("ผ่าน") || t.includes("เสร็จ") || t.includes("completed") || t.includes("done")) return "b-done";

    // Postponed / Hold
    if (t.includes("เลื่อน") || t.includes("พัก") || t.includes("hold") || t.includes("ค้าง") || t.includes("เลื่อนออกไป")) return "b-hold";

    // Waiting / Pending
    if (t.includes("กำลังจะมาถึง") || t.includes("กำลังจะมา") || t.includes("coming") || t.includes("upcoming") ||
        t.includes("รอ") || t.includes("pending") || t.includes("wait") || t.includes("ยังไม่") || t.includes("ยังไม่ได้")) return "b-wait";

    return "b-other";
  }

  // Map index ตามหัวตารางจริงใน Sheet
  function buildIndex(headerRow){
    const norm = headerRow.map(h => (h||"").toLowerCase());
    const find = (keywords) => {
      for (let i=0;i<norm.length;i++){
        const h = norm[i];
        if (keywords.some(k => h.includes(k))) return i;
      }
      return -1;
    };

    const idx = {
      group: find(["กลุ่มผู้เข้าอบรม","กลุ่ม","ประเภท","category","group"]),
      course: find(["หลักสูตร","course"]),
      batch: find(["รุ่น","batch","run"]),
      trainer: find(["วิทยากร","trainer","instructor"]),
      date: find(["วันที่จัดอบรม","วันที่อบรม","วัน","date"]),
      status: find(["สถานะ","status"]),
      link: find(["ลิงก์ทะเบียนรายชื่อ","ลิงก์","link","ทะเบียน"]),
    };

    if (idx.group < 0) idx.group = 0;
    if (idx.course < 0) idx.course = 1;
    if (idx.batch < 0) idx.batch = 2;
    if (idx.trainer < 0) idx.trainer = 3;
    if (idx.date < 0) idx.date = 4;
    if (idx.status < 0) idx.status = 5;
    if (idx.link < 0) idx.link = 6;

    return idx;
  }

  function rebuildFilters(){
    const statuses = uniq(allRows.map(r=>r.status)).sort((a,b)=>a.localeCompare(b,'th'));
    els.fs.innerHTML = '<option value="">สถานะ: ทั้งหมด</option>' +
      statuses.map(s=>'<option value="'+escapeHtml(s)+'">'+escapeHtml(s)+'</option>').join("");

    const years = uniq(allRows.map(r=>r.year)).sort((a,b)=>parseInt(a||"0",10)-parseInt(b||"0",10));
    if (els.fy){
      els.fy.innerHTML = '<option value="">ปี: ทั้งหมด</option>' +
        years.map(y=>'<option value="'+escapeHtml(y)+'">'+escapeHtml(y)+'</option>').join("");
      els.fy.value = "";
    }

    const months = sortMonthKeys(uniq(allRows.map(r=>r.monthKey)));
    els.fm.innerHTML = '<option value="">เดือน: ทั้งหมด</option>' +
      months.map(m=>'<option value="'+escapeHtml(m)+'">'+escapeHtml(m)+'</option>').join("");

    // Default month/year = empty (show "เดือน: ทั้งหมด")
    if (els.fm) els.fm.value = "";

    const courses = uniq(allRows.map(r=>r.course)).sort((a,b)=>a.localeCompare(b,'th'));
    els.fc.innerHTML = '<option value="">หลักสูตร: ทั้งหมด</option>' +
      courses.map(c=>'<option value="'+escapeHtml(c)+'">'+escapeHtml(c)+'</option>').join("");

    const groups = uniq(allRows.map(r=>r.group)).sort((a,b)=>a.localeCompare(b,'th'));
    els.fg.innerHTML = '<option value="">กลุ่มผู้เข้าอบรม: ทั้งหมด</option>' +
      groups.map(g=>'<option value="'+escapeHtml(g)+'">'+escapeHtml(g)+'</option>').join("");

    // default month/year (input) keep empty
    if (els.fmy) els.fmy.value = "";

  }

  // 4) When group is selected, show only courses available in that group
  function updateCourseOptions(){
    const g = els.fg ? els.fg.value : "";
    const current = els.fc ? els.fc.value : "";
    const courses = uniq(allRows
      .filter(r => !g || r.group === g)
      .map(r => r.course))
      .sort((a,b)=>a.localeCompare(b,'th'));

    if (els.fc){
      els.fc.innerHTML = '<option value="">หลักสูตร: ทั้งหมด</option>' +
        courses.map(c=>'<option value="'+escapeHtml(c)+'">'+escapeHtml(c)+'</option>').join("");

      // keep selection if still valid
      if (current && courses.includes(current)) els.fc.value = current;
      else els.fc.value = "";
    }
  }



  

  // === Linked filters (requested): Group -> Course -> Month -> Status ===
  function updateYearOptions(){
    const g = els.fg ? els.fg.value : "";
    const c = els.fc ? els.fc.value : "";

    const years = uniq(allRows
      .filter(r => (!g || r.group === g) && (!c || r.course === c))
      .map(r => r.year))
      .sort((a,b)=>parseInt(a||"0",10)-parseInt(b||"0",10));

    if (els.fy){
      els.fy.innerHTML = '<option value="">ปี: ทั้งหมด</option>' +
        years.map(y=>'<option value="'+escapeHtml(y)+'">'+escapeHtml(y)+'</option>').join("");
      if (!years.includes(els.fy.value)) els.fy.value = "";
    }
  }

  function updateMonthOptions(){
    const g = els.fg ? els.fg.value : "";
    const c = els.fc ? els.fc.value : "";
    const y = els.fy ? els.fy.value : "";

    const months = uniq(allRows
      .filter(r => (!g || r.group === g) && (!c || r.course === c) && (!y || r.year === y))
      .map(r => r.month))
      .sort((a,b)=>(TH_MONTH[a]||99)-(TH_MONTH[b]||99));

    if (els.fm){
      els.fm.innerHTML = '<option value="">เดือน: ทั้งหมด</option>' +
        months.map(m=>'<option value="'+escapeHtml(m)+'">'+escapeHtml(m)+'</option>').join("");
      if (!months.includes(els.fm.value)) els.fm.value = "";
    }
  }

  function updateStatusOptions(){
    const g = els.fg ? els.fg.value : "";
    const c = els.fc ? els.fc.value : "";
    const y = els.fy ? els.fy.value : "";
    const m = els.fm ? els.fm.value : "";

    const statuses = uniq(allRows
      .filter(r => (!g || r.group === g) && (!c || r.course === c) && (!y || r.year === y) && (!m || r.month === m))
      .map(r => r.status))
      .sort((a,b)=>a.localeCompare(b,'th'));

    if (els.fs){
      els.fs.innerHTML = '<option value="">สถานะ: ทั้งหมด</option>' +
        statuses.map(s=>'<option value="'+escapeHtml(s)+'">'+escapeHtml(s)+'</option>').join("");
      if (!statuses.includes(els.fs.value)) els.fs.value = "";
    }
  }
function render(rows){
    els.tbody.innerHTML = "";
    rows.forEach(r=>{
      const group = escapeHtml(r.group);
      const course = escapeHtml(r.course);
      const batch = escapeHtml(r.batch);
      const trainer = escapeHtml(r.trainer);
      const date = escapeHtml(r.date);
      const status = escapeHtml(r.status || "-");

      const statusEl = '<span class="badge '+badgeClass(r.status)+'" title="'+status+'">'+status+'</span>';
      const link = r.link ? '<a class="dl" href="'+r.link+'" target="_blank" rel="noopener">ดาวน์โหลด</a>' : "-";

      els.tbody.insertAdjacentHTML("beforeend",
        '<tr>' +
          '<td class="col-group"><div class="clamp2">'+group+'</div></td>' +
          '<td class="col-course"><div class="clamp2">'+course+'</div></td>' +
          '<td class="col-batch mono">'+batch+'</td>' +
          '<td class="col-trainer"><div class="clamp2">'+trainer+'</div></td>' +
          '<td class="col-date mono">'+date+'</td>' +
          '<td class="col-status">'+statusEl+'</td>' +
          '<td class="col-link">'+link+'</td>' +
        '</tr>'
      );
    });

    els.notice.textContent = rows.length ? ('แสดงผล ' + rows.length + ' รายการ') : "ไม่พบข้อมูล";
  }

  function applyFilters(){
    const g = els.fg ? els.fg.value : '';
    const c = els.fc.value;
    const s = els.fs.value;
    const y = els.fy ? els.fy.value : "";
    const m = els.fm.value;
    const q = (els.q.value || "").toLowerCase().trim();

    let rows = allRows.slice();
    if (g) rows = rows.filter(r => r.group === g);
    if (c) rows = rows.filter(r => r.course === c);
    if (y) rows = rows.filter(r => r.year === y);
    if (m) rows = rows.filter(r => r.month === m);
    if (s) rows = rows.filter(r => r.status === s);
    if (q) rows = rows.filter(r => (
      (r.group||"").toLowerCase().includes(q) ||
      (r.course||"").toLowerCase().includes(q) ||
      (r.trainer||"").toLowerCase().includes(q) ||
      (r.date||"").toLowerCase().includes(q) ||
      (r.status||"").toLowerCase().includes(q) ||
      (r.batch||"").toLowerCase().includes(q)
    ));

    rows.sort((a,b)=>{
      if(!a.dateObj && !b.dateObj) return 0;
      if(!a.dateObj) return 1;
      if(!b.dateObj) return -1;
      return a.dateObj - b.dateObj;
    });

    render(rows);
  }

  function showError(msg){
    els.errorBox.style.display = "block";
    els.errorBox.innerHTML =
      "<b>โหลดไม่สำเร็จ</b> · " + escapeHtml(msg) + "<br>" +
      'ลองเปิดลิงก์ CSV นี้ในเบราว์เซอร์: <a href="'+CSV_URL+'" target="_blank" rel="noopener">เปิด CSV</a><br>' +
      "หมายเหตุ: ห้ามเปิดหน้าเว็บแบบ <b>file://</b> ให้เปิดผ่าน <b>http/https</b> (GitHub Pages หรือ localhost)";
  }

  async function load(){
    els.errorBox.style.display = "none";
    els.notice.textContent = "กำลังโหลดข้อมูล...";
    try{
      const res = await fetch(CSV_URL, { cache: "no-store" });
      if(!res.ok) throw new Error("HTTP " + res.status);
      const text = await res.text();
      const csv = parseCSV(text);
      if(!csv.length || csv.length < 2) throw new Error("CSV ว่าง หรือยังไม่ได้ Publish");

      IDX = buildIndex(csv[0]);
      const data = csv.slice(1).filter(r => r.some(x => (x||"").trim() !== ""));

      allRows = data.map(r=>{
        const dateStr = (r[IDX.date] || "").trim();
        return {
          year: yearFromThaiDate(dateStr),
          month: monthFromThaiDate(dateStr),
          group: (r[IDX.group] || "").trim(),
          course: (r[IDX.course] || "").trim(),
          batch: (r[IDX.batch] || "").trim(),
          trainer: (r[IDX.trainer] || "").trim(),
          date: dateStr,
          status: (r[IDX.status] || "").trim(),
          link: (r[IDX.link] || "").trim(),
          monthKey: monthKeyFromThaiDate(dateStr),
          dateObj: parseThaiDate(dateStr)
        };
      });

      rebuildFilters();
      updateCourseOptions();
      updateMonthOptions();
      updateStatusOptions();
      // sync month/year UI to hidden month filter if possible
      if (els.fmy){
        const key = monthKeyFromMonthInput(els.fmy.value);
        if (key) els.fm.value = key;
      }
      updateStatusOptions();
      applyFilters();
    } catch(e){
      showError(e && e.message ? e.message : "Failed to fetch");
      els.notice.textContent = "โหลดไม่สำเร็จ";
    } finally {    }
  }

  if (els.fg) els.fg.addEventListener("change", ()=>{
    updateCourseOptions();
    updateYearOptions();
    updateYearOptions();
    updateMonthOptions();
    updateStatusOptions();
    applyFilters();
  });
  els.fc.addEventListener("change", ()=>{
    updateMonthOptions();
    updateStatusOptions();
    applyFilters();
  });
  els.fm.addEventListener("change", ()=>{
    updateStatusOptions();
    applyFilters();
  });
  els.fs.addEventListener("change", applyFilters);
  if (els.fmy) els.fmy.addEventListener("change", ()=>{
    const key = monthKeyFromMonthInput(els.fmy.value);
    els.fm.value = key; // sync to hidden select
    updateStatusOptions();
    applyFilters();
  });
  els.q.addEventListener("input", applyFilters);


  // --- Scroll indicator for table (horizontal scroll hint) ---
  const tableWrap = document.getElementById("tablewrap");
  const scrollThumb = document.getElementById("scrollThumb");
  function updateScrollThumb(){
    if(!tableWrap || !scrollThumb) return;
    const maxScroll = tableWrap.scrollWidth - tableWrap.clientWidth;
    if(maxScroll <= 0){
      scrollThumb.style.width = "100%";
      scrollThumb.style.transform = "translateX(0)";
      return;
    }
    const thumbW = Math.max(24, Math.round((tableWrap.clientWidth / tableWrap.scrollWidth) * tableWrap.clientWidth));
    const left = Math.round((tableWrap.scrollLeft / maxScroll) * (tableWrap.clientWidth - thumbW));
    scrollThumb.style.width = thumbW + "px";
    scrollThumb.style.transform = "translateX(" + left + "px)";
  }
  if(tableWrap){
    tableWrap.addEventListener("scroll", updateScrollThumb, {passive:true});
    window.addEventListener("resize", updateScrollThumb);
    setTimeout(updateScrollThumb, 0);
  }

  load();
</script>
</body>
</html>
